<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>バラシュナ暗記法</title>

<link rel="manifest" href="./manifest.webmanifest?v=8">
<meta name="theme-color" content="#1f1335">

<!-- iOS（ホーム画面追加のアイコン&名前） -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="バラシュナ暗記">
<link rel="apple-touch-icon" href="./icons/icon-180.png" sizes="180x180">

  <!-- CSS -->
  <link rel="stylesheet" href="./style.css">
</head>
<body>

  <div class="baras-wrap" id="baras">
    <header class="baras-head">
      <div class="head-left">
        <h1 class="app-title">バラシュナ暗記：1問1答</h1>
        <div class="meta">
          <span id="meta-q">Q:1/20</span>
          <span id="meta-acc">正答率:0%</span>
          <span id="meta-streak">連続:0 (Best:0)</span>
        </div>
      </div>
      <div class="head-right">
        <label class="toggle"><input type="checkbox" id="opt-hard"> 不正解優先</label>
      </div>
    </header>

    <div class="progress"><div class="bar" id="progress-bar"></div></div>

    <main class="card">
      <h2 class="question" id="qtext">問題テキスト</h2>
      <div class="choices" id="choices"></div>
      <button class="next" id="nextBtn" disabled>つぎの問題へ</button>
      <div class="sr" aria-live="polite" id="live"></div>
    </main>
  </div>

  <!-- 背景エフェクト -->
  <div class="baras-bg" aria-hidden="true">
    <div class="aura"></div>
    <div class="grain"></div>
  </div>

  <!-- Service Worker -->
  <script>
    if ('serviceWorker' in navigator) {
      const isSecure = location.protocol === 'https:' || location.hostname === 'localhost' || location.hostname === '127.0.0.1';
      if (isSecure) navigator.serviceWorker.register('./sw.js', { scope: './' });
    }
  </script>

  <!-- App -->
  <script src="./app.js?v=6"></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistration().then(r => r?.update());
    }
  </script>

  <!-- Install banner (PWA) -->
  <div id="install-banner" style="display:none; position:fixed; inset:auto 16px 16px 16px; padding:16px; border-radius:12px; background:#1f1335; color:#fff; box-shadow:0 10px 30px rgba(0,0,0,.35); z-index:99999;">
    <div id="install-msg" style="margin-bottom:10px; font-weight:700;">アプリをホーム画面に追加できます</div>
    <div style="display:flex; gap:8px; justify-content:flex-end;">
      <button id="install-cancel" style="padding:8px 12px; border-radius:8px; background:#444; color:#fff;">あとで</button>
      <button id="install-cta" style="padding:8px 12px; border-radius:8px; background:#6c4bff; color:#fff; font-weight:700;">インストール</button>
    </div>
  </div>

</body>
</html>
